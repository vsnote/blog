<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>广告 on 陈三</title>
    <link>https://www.zfanw.com/blog/tags/%E5%B9%BF%E5%91%8A/</link>
    <description>Recent content in 广告 on 陈三</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Sun, 11 Jan 2015 12:03:52 +0000</lastBuildDate>
    <atom:link href="https://www.zfanw.com/blog/tags/%E5%B9%BF%E5%91%8A/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Privoxy 去除 iOS 爱奇艺客户端广告</title>
      <link>https://www.zfanw.com/blog/privoxy-remove-iqiyi-ios-client-ad.html</link>
      <pubDate>Sun, 11 Jan 2015 12:03:52 +0000</pubDate>
      
      <guid>https://www.zfanw.com/blog/privoxy-remove-iqiyi-ios-client-ad.html</guid>
      <description>&lt;div id=&#34;toc_container&#34; class=&#34;ml-l u-floatRight pure-u-1-1 pure-u-sm-2-5 toc_white no_bullets&#34;&gt;
  &lt;nav id=&#34;myaffix&#34;&gt;
  
  &lt;p class=&#34;toc-title&#34;&gt;
    目录
  &lt;/p&gt;
  
  &lt;ul class=&#34;toc-list nav&#34; role=&#34;menu&#34;&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#i&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;1&lt;/span&gt; 分析&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#_Privoxy&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;2&lt;/span&gt; 设定 Privoxy 规则&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#_Privoxy-2&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;3&lt;/span&gt; 修改 Privoxy 监听地址&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#i-2&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;4&lt;/span&gt; 更新&lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;&lt;/nav&gt;
&lt;/div&gt;

&lt;div class=&#34;&#34;&gt;
  &lt;p&gt;
    此前有人写邮件问我，Privoxy 如何去掉 iOS 上爱奇艺客户端的视频广告。当时我没时间，只大致给了几个建议，然后不了了之，没了下文。但心里记挂，想着什么时候有时间，要认真看看。所以就有了这一篇。
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;i&#34;&gt;分析&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;heyi&#34; href=&#34;#i&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    涉及的设备及软件等如下：
  &lt;/p&gt;
  
  &lt;ul&gt;
    &lt;li&gt;
      iPhone 4s, 7.1.2 版本
    &lt;/li&gt;
    &lt;li&gt;
      ThinkPad，装有 openSUSE 13.2 32 位操作系统
    &lt;/li&gt;
    &lt;li&gt;
      Charles Proxy，收费的，Windows 系统下可以使用免费的 Fiddler2
    &lt;/li&gt;
  &lt;/ul&gt;
  
  &lt;h3&gt;
    预备工具
  &lt;/h3&gt;
  
  &lt;ol&gt;
    &lt;li&gt;
      将 iPhone 与 ThinkPad 连入同一个 WIFI 环境
    &lt;/li&gt;
    &lt;li&gt;
      打开 iPhone 的 WIFI 连接设置，设置 HTTP Proxy（代理）为 ThinkPad 上 Charles Proxy 的 ip:port，比如我的：&lt;code&gt;192.168.1.102:8888&lt;/code&gt;，手机上如有开启 VPN 之类的，请暂先关闭
    &lt;/li&gt;
  &lt;/ol&gt;
  
  &lt;p&gt;
    现在查看 charles 的话，应该已经能看见 iPhone 上的 HTTP 请求/响应进出了。
  &lt;/p&gt;
  
  &lt;h3&gt;
    打开爱奇艺客户端
  &lt;/h3&gt;
  
  &lt;p&gt;
    现在打开爱奇艺客户端，点开一个视频，就能看到类似如下的请求：
  &lt;/p&gt;
  
  &lt;blockquote&gt;
    &lt;p&gt;
      http://iface2.iqiyi.com/php/xyz/entry/nebula.php?key=8e48946f144759d86a50075555fd5862&amp;app_key=8e48946f144759d86a50075555fd5862&amp;did=b1f4b27f4627d038&amp;type=json&amp;id=&amp;deviceid=&amp;version=5.7.1&amp;os=7.1.2&amp;ua=iPhone4,1&amp;network=1&amp;screen_status=1&amp;udid=aeb89eb1a451f9e6082246e79e077bc543e327ae&amp;ss=1&amp;ppid=&amp;uid=&amp;uniqid=0f607264fc6318a92b9e13c65db7cd3c&amp;openudid=aeb89eb1a451f9e6082246e79e077bc543e327ae&amp;idfv=5D1578BE-ECE1-406E-A99F-42AB99A71130&amp;idfa=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;qyid=aeb89eb1a451f9e6082246e79e077bc543e327ae&amp;mac_md5=e3f5536a141811db40efd6400f1d0a4e&amp;cc=%257B%250A%2520%2520%2520%2520cc%2520%253D%2520%2522%255CU6d77%255CU5916%255CU8fd0%255CU8425%255CU5546%2522%253B%250A%2520%2520%2520%2520city%2520%253D%2520%2522%255CU6d77%255CU5916%2522%253B%250A%2520%2520%2520%2520province%2520%253D%2520%2522%255CU6d77%255CU5916%2522%253B%250A%2520%2520%2520%2520respcode%2520%253D%25200%253B%250A%2520%2520%2520%2520timeout%2520%253D%25200%253B%250A%257D&amp;agenttype=20&amp;screen_res=640&lt;em&gt;960&amp;resolution=640&lt;/em&gt;960&amp;cookie=0&amp;ppid=(null)&amp;user_res=4&amp;js=0&amp;a=0&amp;b=0&amp;x=0&amp;y=5&amp;z=0&amp;r=0&amp;v_m=2.5_002&amp;vs=0&amp;vt=0.000000&amp;other=1&amp;block=0&amp;ad=2&amp;ad_str=1&amp;w=0&amp;compat=1&amp;v5=1&amp;core=0&amp;sn=1420974668080402944&amp;api=2.4&amp;cts=1420974668&amp;platform=iPhone&amp;pps=0&amp;support_db=&amp;many_id=331794000_331794000_0
    &lt;/p&gt;
  &lt;/blockquote&gt;
  
  &lt;p&gt;
    广告就隐藏在这条请求的响应中：
  &lt;/p&gt;
  
  &lt;blockquote&gt;
    &lt;p&gt;
      HTTP/1.1 200 OK
    &lt;/p&gt;
    
    &lt;p&gt;
      Server: nginx
    &lt;/p&gt;
    
    &lt;p&gt;
      Date: Sun, 11 Jan 2015 11:11:09 GMT
    &lt;/p&gt;
    
    &lt;p&gt;
      Content-Type: text/json
    &lt;/p&gt;
    
    &lt;p&gt;
      Connection: close
    &lt;/p&gt;
    
    &lt;p&gt;
      X-Powered-By: PHP/5.3.6
    &lt;/p&gt;
    
    &lt;p&gt;
      Vary: Accept-Encoding
    &lt;/p&gt;
    
    &lt;p&gt;
      Expires: 0
    &lt;/p&gt;
    
    &lt;p&gt;
      Cache-Control: no-cache
    &lt;/p&gt;
  &lt;/blockquote&gt;
  
  &lt;blockquote&gt;
    {&amp;#8220;_as&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;_blk&amp;#8221;:0,&amp;#8221;_cid&amp;#8221;:4,&amp;#8221;_ct&amp;#8221;:&amp;#8221;2014-12-05 16:35:45&amp;#8243;,&amp;#8221;_da&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;_dl&amp;#8221;:1,&amp;#8221;_dn&amp;#8221;:&amp;#8221;219&amp;#8243;,&amp;#8221;_id&amp;#8221;:&amp;#8221;331794000&amp;#8243;,&amp;#8221;_img&amp;#8221;:&amp;#8221;http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_120_160.jpg&amp;#8221;,&amp;#8221;_ip&amp;#8221;:0,&amp;#8221;_ma&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;_pc&amp;#8221;:0,&amp;#8221;_pid&amp;#8221;:0,&amp;#8221;_reseftv&amp;#8221;:175,&amp;#8221;_t&amp;#8221;:&amp;#8221;\u3010\u521d\u97f3miku\u3011\u30a2\u30ea\u30a2\u30c9\u30cd\u3010\u9ed2\u3046\u3055P\u3011&amp;#8243;,&amp;#8221;_tvct&amp;#8221;:5,&amp;#8221;_tvs&amp;#8221;:1,&amp;#8221;_vt&amp;#8221;:12,&amp;#8221;a_av&amp;#8221;:1,&amp;#8221;a_pro&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;bpt&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;clm&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;cn_year&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;co_album_id&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;ctype&amp;#8221;:0,&amp;#8221;desc&amp;#8221;:&amp;#8221;\u65e0&amp;#8243;,&amp;#8221;down&amp;#8221;:3,&amp;#8221;down2&amp;#8243;:&amp;#8221;3&amp;#8243;,&amp;#8221;drm&amp;#8221;:0,&amp;#8221;fst_time&amp;#8221;:&amp;#8221;2014-12-05&amp;#8243;,&amp;#8221;h1_img&amp;#8221;:&amp;#8221;http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_180_236.jpg&amp;#8221;,&amp;#8221;h2_img&amp;#8221;:&amp;#8221;http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_195_260.jpg&amp;#8221;,&amp;#8221;is_h&amp;#8221;:0,&amp;#8221;is_n&amp;#8221;:0,&amp;#8221;is_zb&amp;#8221;:0,&amp;#8221;k_word&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;language&amp;#8221;:0,&amp;#8221;live_center&amp;#8221;:0,&amp;#8221;live_start_time&amp;#8221;:0,&amp;#8221;live_stop_time&amp;#8221;:0,&amp;#8221;logo&amp;#8221;:1,&amp;#8221;m_av&amp;#8221;:1,&amp;#8221;mts&amp;#8221;:0,&amp;#8221;p_av&amp;#8221;:1,&amp;#8221;p_s&amp;#8221;:1,&amp;#8221;p_s_1&amp;#8243;:1,&amp;#8221;p_s_4&amp;#8243;:1,&amp;#8221;p_s_8&amp;#8243;:1,&amp;#8221;qct&amp;#8221;:25,&amp;#8221;qiyi_pro&amp;#8221;:0,&amp;#8221;qiyi_year&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;qt_id&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;s_TT&amp;#8221;:&amp;#8221;sm25051115&amp;#8243;,&amp;#8221;songname&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;t_pc&amp;#8221;:0,&amp;#8221;tag&amp;#8221;:&amp;#8221;\u65e5\u672c \u540c\u4eba ACG \u7279\u522b\u7248&amp;#8243;,&amp;#8221;tv_eftv&amp;#8221;:1,&amp;#8221;tv_pha&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;tv_pro&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;tv_ss&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;tvfcs&amp;#8221;:&amp;#8221;\u7231\u5947\u827a\u7231\u52a8\u6f2b&amp;#8221;,&amp;#8221;up&amp;#8221;:9,&amp;#8221;up2&amp;#8243;:&amp;#8221;9&amp;#8243;,&amp;#8221;upcl&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;v2_img&amp;#8221;:&amp;#8221;http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_284_160.jpg&amp;#8221;,&amp;#8221;v3_img&amp;#8221;:&amp;#8221;http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_480_270.jpg&amp;#8221;,&amp;#8221;vv&amp;#8221;:&amp;#8221;5403&amp;#8243;,&amp;#8221;year&amp;#8221;:&amp;#8221;2014&amp;#8243;,&amp;#8221;tv_id&amp;#8221;:331794000,&amp;#8221;vv_p&amp;#8221;:61,&amp;#8221;vv_f&amp;#8221;:2,&amp;#8221;vv_m&amp;#8221;:39,&amp;#8221;_sc&amp;#8221;:7.5,&amp;#8221;r_vv&amp;#8221;:5403,&amp;#8221;cpt_l&amp;#8221;:0,&amp;#8221;cpt_r&amp;#8221;:0,&amp;#8221;load_img&amp;#8221;:&amp;#8221;st&amp;#8221;,&amp;#8221;fst_time2&amp;#8243;:&amp;#8221;&amp;#8221;,&amp;#8221;disable&amp;#8221;:0,&amp;#8221;weburl&amp;#8221;:&amp;#8221;http:\/\/m.iqiyi.com\/v_19rrn82058.html&amp;#8221;,&amp;#8221;auth&amp;#8221;:1,&amp;#8221;auth_error&amp;#8221;:0,&amp;#8221;tv&amp;#8221;:{&amp;#8220;block&amp;#8221;:[],&amp;#8221;block_now&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;count&amp;#8221;:1,&amp;#8221;other&amp;#8221;:[&amp;#8220;331794000~331794000~\u3010\u521d\u97f3miku\u3011\u30a2\u30ea\u30a2\u30c9\u30cd\u3010\u9ed2\u3046\u3055P\u3011~1~2014~http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_160_90.jpg~~~~~~sm25051115~0~1~5403~http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_284_160.jpg~2014~2014-12-05~~~\u65e5\u672c \u540c\u4eba ACG \u7279\u522b\u7248~219~0~1~1~0~0~\u7231\u5947\u827a\u7231\u52a8\u6f2b~~~0~http:\/\/m.iqiyi.com\/v_19rrn82058.html~0~0~0~0~0&amp;#8243;],&amp;#8221;0&amp;#8221;:{&amp;#8220;_id&amp;#8221;:&amp;#8221;331794000&amp;#8243;,&amp;#8221;_n&amp;#8221;:&amp;#8221;\u3010\u521d\u97f3miku\u3011\u30a2\u30ea\u30a2\u30c9\u30cd\u3010\u9ed2\u3046\u3055P\u3011&amp;#8243;,&amp;#8221;desc&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;_od&amp;#8221;:1,&amp;#8221;_dn&amp;#8221;:219,&amp;#8221;s_t&amp;#8221;:-1,&amp;#8221;e_t&amp;#8221;:-1,&amp;#8221;res&amp;#8221;:[{&amp;#8220;s&amp;#8221;:1,&amp;#8221;t&amp;#8221;:&amp;#8221;TS2&amp;#8243;,&amp;#8221;_v&amp;#8221;:&amp;#8221;e9898ca6870778b9a6f6a909fc763646&amp;#8243;,&amp;#8221;r_t&amp;#8221;:&amp;#8221;8&amp;#8243;,&amp;#8221;url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;len&amp;#8221;:24230959,&amp;#8221;vid&amp;#8221;:&amp;#8221;http:\/\/cache.m.iqiyi.com\/dc\/dt\/mobile\/20141205\/dd\/6d\/c495ecbe9e6cace8c70d627f97113b69.m3u8?qypid=331794000_32&amp;qd_src=5be6a2fdfe4f4a1a8c7b08ee46a18887&amp;qd_tm=1420974669000&amp;qd_ip=104.200.18.10&amp;qd_sc=41c33c35701ea3789da74f6233714380&amp;#8243;,&amp;#8221;fid&amp;#8221;:&amp;#8221;OEVB5H6VUDZNWECGMJKPU3KRH7XLIO6B&amp;#8221;,&amp;#8221;pps&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;pps_url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;uniq_id&amp;#8221;:&amp;#8221;100080001&amp;#8243;,&amp;#8221;_tsurl&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;type&amp;#8221;:1,&amp;#8221;f4v_url&amp;#8221;:&amp;#8221;http:\/\/cache.video.qiyi.com\/vp\/331794000\/e9898ca6870778b9a6f6a909fc763646\/&amp;#8221;},{&amp;#8220;s&amp;#8221;:2,&amp;#8221;t&amp;#8221;:&amp;#8221;TS1&amp;#8243;,&amp;#8221;_v&amp;#8221;:&amp;#8221;bb620e84cffc480d53f85d8842697cee&amp;#8221;,&amp;#8221;r_t&amp;#8221;:&amp;#8221;4&amp;#8243;,&amp;#8221;url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;len&amp;#8221;:11113689,&amp;#8221;vid&amp;#8221;:&amp;#8221;http:\/\/cache.m.iqiyi.com\/dc\/dt\/mobile\/20141205\/95\/52\/cf82ab38c9949b20b2bf82ccab67777e.m3u8?qypid=331794000_32&amp;qd_src=5be6a2fdfe4f4a1a8c7b08ee46a18887&amp;qd_tm=1420974669000&amp;qd_ip=104.200.18.10&amp;qd_sc=c920c9a8c06403a72e0e149661aa683e&amp;#8221;,&amp;#8221;fid&amp;#8221;:&amp;#8221;34DSQJCHX6YW46NDC4KU7CVWZXCT5MVU&amp;#8221;,&amp;#8221;pps&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;pps_url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;uniq_id&amp;#8221;:&amp;#8221;100040001&amp;#8243;,&amp;#8221;_tsurl&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;type&amp;#8221;:1,&amp;#8221;f4v_url&amp;#8221;:&amp;#8221;http:\/\/cache.video.qiyi.com\/vp\/331794000\/bb620e84cffc480d53f85d8842697cee\/&amp;#8221;},{&amp;#8220;s&amp;#8221;:3,&amp;#8221;t&amp;#8221;:&amp;#8221;TS4&amp;#8243;,&amp;#8221;_v&amp;#8221;:&amp;#8221;bd5ea43cdb556e035fa5ee99d2157e12&amp;#8243;,&amp;#8221;r_t&amp;#8221;:&amp;#8221;128&amp;#8243;,&amp;#8221;url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;len&amp;#8221;:4673682,&amp;#8221;vid&amp;#8221;:&amp;#8221;http:\/\/cache.m.iqiyi.com\/dc\/dt\/mobile\/20141205\/2a\/74\/4f64780f9f4524311fa367414d8e5666.m3u8?qypid=331794000_32&amp;qd_src=5be6a2fdfe4f4a1a8c7b08ee46a18887&amp;qd_tm=1420974669000&amp;qd_ip=104.200.18.10&amp;qd_sc=4fbf13db970809a4e16ac3270f17f688&amp;#8243;,&amp;#8221;fid&amp;#8221;:&amp;#8221;CXFDFGWWNA6NVMBD7RHLEY2X7DQK7QTE&amp;#8221;,&amp;#8221;pps&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;pps_url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;uniq_id&amp;#8221;:&amp;#8221;101280001&amp;#8243;,&amp;#8221;_tsurl&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;type&amp;#8221;:1,&amp;#8221;f4v_url&amp;#8221;:&amp;#8221;http:\/\/cache.video.qiyi.com\/vp\/331794000\/bd5ea43cdb556e035fa5ee99d2157e12\/&amp;#8221;}],&amp;#8221;len&amp;#8221;:11113689,&amp;#8221;vid&amp;#8221;:&amp;#8221;http:\/\/cache.m.iqiyi.com\/dc\/dt\/mobile\/20141205\/95\/52\/cf82ab38c9949b20b2bf82ccab67777e.m3u8?qypid=331794000_32&amp;qd_src=5be6a2fdfe4f4a1a8c7b08ee46a18887&amp;qd_tm=1420974669000&amp;qd_ip=104.200.18.10&amp;qd_sc=c920c9a8c06403a72e0e149661aa683e&amp;#8221;,&amp;#8221;url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;_img&amp;#8221;:&amp;#8221;http:\/\/pic8.qiyipic.com\/image\/20141205\/4e\/7f\/v_108765570_m_601_160_90.jpg&amp;#8221;,&amp;#8221;web_url&amp;#8221;:&amp;#8221;http:\/\/m.iqiyi.com\/v_19rrn82058.html&amp;#8221;,&amp;#8221;albumid&amp;#8221;:&amp;#8221;331794000&amp;#8243;,&amp;#8221;subtitle&amp;#8221;:&amp;#8221;sm25051115&amp;#8243;,&amp;#8221;comment_on&amp;#8221;:1,&amp;#8221;_dv&amp;#8221;:&amp;#8221;e9898ca6870778b9a6f6a909fc763646&amp;#8243;,&amp;#8221;vote_id&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;_durl&amp;#8221;:&amp;#8221;http:\/\/data.video.qiyi.com\/videos\/v0\/20141205\/3d\/e7\/5d6c11ae9b1d465afd506c5fefbe4559.mp4?qypid=331794000_32&amp;v=827122190&amp;qd_src=app&amp;qd_tm=1420974669000&amp;qd_ip=104.200.18.10&amp;qd_sc=92f4366fcb5a64db3c00a706388d7fe2&amp;#8243;,&amp;#8221;_dlen&amp;#8221;:11971286,&amp;#8221;pps&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;fid&amp;#8221;:&amp;#8221;34DSQJCHX6YW46NDC4KU7CVWZXCT5MVU&amp;#8221;,&amp;#8221;_res&amp;#8221;:&amp;#8221;4&amp;#8243;,&amp;#8221;_v&amp;#8221;:&amp;#8221;bb620e84cffc480d53f85d8842697cee&amp;#8221;,&amp;#8221;pps_url&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;f4v_url&amp;#8221;:&amp;#8221;http:\/\/cache.video.qiyi.com\/vp\/331794000\/bb620e84cffc480d53f85d8842697cee\/&amp;#8221;,&amp;#8221;ad_str&amp;#8221;:&amp;#8221;{\&amp;#8221;ip\&amp;#8221;:\&amp;#8221;10.11.49.120\&amp;#8221;,\&amp;#8221;cupidExtras\&amp;#8221;:{\&amp;#8221;enableMiaozhenSDK\&amp;#8221;:1,\&amp;#8221;enableAdMasterSDK\&amp;#8221;:1,\&amp;#8221;enableAlimama\&amp;#8221;:0,\&amp;#8221;enableMmaMiaozhen\&amp;#8221;:1,\&amp;#8221;enableMmaCtr\&amp;#8221;:1,\&amp;#8221;alimamaId\&amp;#8221;:71000017,\&amp;#8221;enableMmaNielsen\&amp;#8221;:1,\&amp;#8221;enableMmaAdMaster\&amp;#8221;:1},\&amp;#8221;futureSlots\&amp;#8221;:[{\&amp;#8221;startTime\&amp;#8221;:300,\&amp;#8221;type\&amp;#8221;:4}],\&amp;#8221;reqUrl\&amp;#8221;:\&amp;#8221;\\\/mixer?a=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;b=331794000&amp;c=bb620e84cffc480d53f85d8842697cee&amp;d=qc_100001_100070&amp;e=5.7.1&amp;f=4&amp;g=104.200.18.10&amp;h=331794000&amp;i=iPhone&amp;k=4&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4%2C1&amp;n=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=0b05078afb5a24f5f97fadac83632383&amp;vn=0&amp;vd=0&amp;r=2.5_002&amp;rn=0&amp;bd=219&amp;p=-1&amp;x=0&amp;tp=0&amp;nw=1&amp;vs=0&amp;pi=&amp;pc=0&amp;cts=1420974668&amp;lts=&amp;y=103,1,2&amp;fa=4&amp;ut=0\&amp;#8221;,\&amp;#8221;version\&amp;#8221;:\&amp;#8221;2.0.8526\&amp;#8221;,\&amp;#8221;adSlots\&amp;#8221;:[{\&amp;#8221;startTime\&amp;#8221;:0,\&amp;#8221;duration\&amp;#8221;:30,\&amp;#8221;type\&amp;#8221;:1,\&amp;#8221;slotExtras\&amp;#8221;:{},\&amp;#8221;adZoneId\&amp;#8221;:\&amp;#8221;1000000000381\&amp;#8221;,\&amp;#8221;ads\&amp;#8221;:[{\&amp;#8221;adExtras\&amp;#8221;:{},\&amp;#8221;clickTracking\&amp;#8221;:{\&amp;#8221;adxTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000678217&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=1&amp;b=1420974669\&amp;#8221;],\&amp;#8221;cupidTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/track2?a=1&amp;b=1420974669&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;d=5000000675829&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000678217&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=dafea75e967cef6a25e0060b5aefbeb4&amp;t=iPhone&amp;u=1&amp;w=2&amp;up=&amp;v=5000000675829\&amp;#8221;]},\&amp;#8221;impressionId\&amp;#8221;:\&amp;#8221;1a9d6aa5607c24198908e4ecb7f36971\&amp;#8221;,\&amp;#8221;vid\&amp;#8221;:\&amp;#8221;327d76cda8d3e7c29a41a52f1cb41ff8\&amp;#8221;,\&amp;#8221;priority\&amp;#8221;:88,\&amp;#8221;dspId\&amp;#8221;:71000001,\&amp;#8221;order\&amp;#8221;:1,\&amp;#8221;duration\&amp;#8221;:15,\&amp;#8221;clickThroughUrl\&amp;#8221;:\&amp;#8221;http:\\\/\\\/wt.game.pps.tv\\\/index.php?m=adsmd&amp;c=tiepian&amp;a=index&amp;id=7421\&amp;#8221;,\&amp;#8221;impressionTracking\&amp;#8221;:{\&amp;#8221;adxTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000678217&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=0&amp;b=1420974669\&amp;#8221;],\&amp;#8221;cupidTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/track2?a=0&amp;b=1420974669&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;d=5000000675829&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000678217&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=dafea75e967cef6a25e0060b5aefbeb4&amp;t=iPhone&amp;u=1&amp;w=2&amp;up=&amp;v=5000000675829\&amp;#8221;]},\&amp;#8221;creativeType\&amp;#8221;:\&amp;#8221;video_m3u8\&amp;#8221;,\&amp;#8221;clickThroughType\&amp;#8221;:\&amp;#8221;0\&amp;#8221;,\&amp;#8221;orderItemId\&amp;#8221;:\&amp;#8221;5000000675829\&amp;#8221;,\&amp;#8221;timePosition\&amp;#8221;:\&amp;#8221;2\&amp;#8221;,\&amp;#8221;adId\&amp;#8221;:\&amp;#8221;5000000677723\&amp;#8221;,\&amp;#8221;creativeObject\&amp;#8221;:{},\&amp;#8221;creativeUrl\&amp;#8221;:\&amp;#8221;\&amp;#8221;,\&amp;#8221;creativeId\&amp;#8221;:\&amp;#8221;5000000678217\&amp;#8221;},{\&amp;#8221;adExtras\&amp;#8221;:{},\&amp;#8221;clickTracking\&amp;#8221;:{\&amp;#8221;adxTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000591849&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=1&amp;b=1420974669\&amp;#8221;],\&amp;#8221;cupidTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/track2?a=1&amp;b=1420974669&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;d=5000000589321&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000591849&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=ddfc1cc2443276e5f8a2ea298a7774a8&amp;t=iPhone&amp;u=1&amp;w=3&amp;up=&amp;v=5000000589321\&amp;#8221;]},\&amp;#8221;impressionId\&amp;#8221;:\&amp;#8221;84e5330e3497a4c52b4ecfcd84e98f05\&amp;#8221;,\&amp;#8221;vid\&amp;#8221;:\&amp;#8221;7d1bf186a55a5ae0bb2ad051666adb89\&amp;#8221;,\&amp;#8221;priority\&amp;#8221;:88,\&amp;#8221;dspId\&amp;#8221;:71000001,\&amp;#8221;order\&amp;#8221;:2,\&amp;#8221;duration\&amp;#8221;:15,\&amp;#8221;clickThroughUrl\&amp;#8221;:\&amp;#8221;http:\\\/\\\/serv.vip.iqiyi.com\\\/order\\\/preview.action?pid=a0226bd958843452&amp;platform=bb35a104d95490f6&amp;fc=a3dbfe9e7b9dba94#type=0\&amp;#8221;,\&amp;#8221;impressionTracking\&amp;#8221;:{\&amp;#8221;adxTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000591849&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=0&amp;b=1420974669\&amp;#8221;],\&amp;#8221;cupidTracking\&amp;#8221;:[\&amp;#8221;http:\\\/\\\/api.cupid.qiyi.com\\\/track2?a=0&amp;b=1420974669&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;d=5000000589321&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000591849&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=ddfc1cc2443276e5f8a2ea298a7774a8&amp;t=iPhone&amp;u=1&amp;w=3&amp;up=&amp;v=5000000589321\&amp;#8221;]},\&amp;#8221;creativeType\&amp;#8221;:\&amp;#8221;video_m3u8\&amp;#8221;,\&amp;#8221;clickThroughType\&amp;#8221;:\&amp;#8221;3\&amp;#8221;,\&amp;#8221;orderItemId\&amp;#8221;:\&amp;#8221;5000000589321\&amp;#8221;,\&amp;#8221;timePosition\&amp;#8221;:\&amp;#8221;3\&amp;#8221;,\&amp;#8221;adId\&amp;#8221;:\&amp;#8221;5000000591634\&amp;#8221;,\&amp;#8221;creativeObject\&amp;#8221;:{},\&amp;#8221;creativeUrl\&amp;#8221;:\&amp;#8221;\&amp;#8221;,\&amp;#8221;creativeId\&amp;#8221;:\&amp;#8221;5000000591849\&amp;#8221;}]}],\&amp;#8221;videoEventId\&amp;#8221;:\&amp;#8221;0b05078afb5a24f5f97fadac83632383\&amp;#8221;,\&amp;#8221;finalUrl\&amp;#8221;:\&amp;#8221;http:\\\/\\\/cache.m.iqiyi.com\\\/dc\\\/amdt\\\/ae7578x3cd43d3f\\\/327d76cda8d3e7c29a41a52f1cb41ff8-7d1bf186a55a5ae0bb2ad051666adb89\\\/331794000\\\/bb620e84cffc480d53f85d8842697cee.m3u8?qd_asc=ae4f1fc1098e13132ea08c9490e419ee&amp;qd_asrc=8c40568b52a2483ea7e88a948c7ed664&amp;qd_at=1420974669569&amp;qypid=331794000_32\&amp;#8221;}&amp;#8221;}},&amp;#8221;sn&amp;#8221;:&amp;#8221;1420974668080402944&amp;#8243;,&amp;#8221;_tab&amp;#8221;:[{&amp;#8220;id&amp;#8221;:2,&amp;#8221;name&amp;#8221;:&amp;#8221;\u8be6\u60c5\u8bc4\u8bba&amp;#8221;,&amp;#8221;default&amp;#8221;:0},{&amp;#8220;id&amp;#8221;:3,&amp;#8221;name&amp;#8221;:&amp;#8221;\u731c\u4f60\u559c\u6b22&amp;#8243;,&amp;#8221;default&amp;#8221;:1}],&amp;#8221;cupid_app_on&amp;#8221;:1,&amp;#8221;cupid_app_tab&amp;#8221;:3,&amp;#8221;_av&amp;#8221;:1,&amp;#8221;album_barrage&amp;#8221;:1,&amp;#8221;album_barrage_lines&amp;#8221;:3,&amp;#8221;cupid_ut&amp;#8221;:0,&amp;#8221;cupid_nw&amp;#8221;:1,&amp;#8221;cupid_expire&amp;#8221;:3}
  &lt;/blockquote&gt;
  
  &lt;p&gt;
    以上是请求的原始响应报文，可以借用 charles 提供的 JSON 方式查看：
  &lt;/p&gt;
  
  &lt;p&gt;
    [resp_image id=&amp;#8217;14942&amp;#8242; caption=&amp;#8221; ]
  &lt;/p&gt;
  
  &lt;p&gt;
    由于对 iOS 上视频播放的机制并不熟悉，所以我只能一个一个测试过去，然后大致了解返回的数据是什么意思：
  &lt;/p&gt;
  
  &lt;ul&gt;
    &lt;li&gt;
      &lt;code&gt;tv&lt;/code&gt; 键名下有个 &lt;code&gt;res&lt;/code&gt;，里面有三个对象，包含的是三个清晰度的视频版本，其中有视频路径，格式为 m3u8，比如 &lt;code&gt;http://cache.m.iqiyi.com/dc/dt/mobile/20141205/dd/6d/c495ecbe9e6cace8c70d627f97113b69.m3u8?qypid=331794000_32&amp;qd_src=5be6a2fdfe4f4a1a8c7b08ee46a18887&amp;qd_tm=1420974669000&amp;qd_ip=104.200.18.10&amp;qd_sc=41c33c35701ea3789da74f6233714380&lt;/code&gt;，在浏览器中打开这个路径，就可以下载 m3u8 文件，然后用 mplayer 等工具即可播放，借助 ffmpeg 工具也可以将它下载到本地。
    &lt;/li&gt;
    &lt;li&gt;
      &lt;code&gt;tab&lt;/code&gt; 键名下有两个对象，包含是的”详情评论“和”猜你喜欢“，这是视频下的两个标签页。
    &lt;/li&gt;
  &lt;/ul&gt;
  
  &lt;p&gt;
    经过排查，大致锁定一个叫 &lt;code&gt;ad_str&lt;/code&gt; 的键名，其值如下：
  &lt;/p&gt;
  
  &lt;blockquote&gt;
    &lt;p&gt;
      {&amp;#8220;ip&amp;#8221;:&amp;#8221;10.11.49.120&amp;#8243;,&amp;#8221;cupidExtras&amp;#8221;:{&amp;#8220;enableMiaozhenSDK&amp;#8221;:1,&amp;#8221;enableAdMasterSDK&amp;#8221;:1,&amp;#8221;enableAlimama&amp;#8221;:0,&amp;#8221;enableMmaMiaozhen&amp;#8221;:1,&amp;#8221;enableMmaCtr&amp;#8221;:1,&amp;#8221;alimamaId&amp;#8221;:71000017,&amp;#8221;enableMmaNielsen&amp;#8221;:1,&amp;#8221;enableMmaAdMaster&amp;#8221;:1},&amp;#8221;futureSlots&amp;#8221;:[{&amp;#8220;startTime&amp;#8221;:300,&amp;#8221;type&amp;#8221;:4}],&amp;#8221;reqUrl&amp;#8221;:&amp;#8221;\/mixer?a=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;b=331794000&amp;c=bb620e84cffc480d53f85d8842697cee&amp;d=qc_100001_100070&amp;e=5.7.1&amp;f=4&amp;g=104.200.18.10&amp;h=331794000&amp;i=iPhone&amp;k=4&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4%2C1&amp;n=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=0b05078afb5a24f5f97fadac83632383&amp;vn=0&amp;vd=0&amp;r=2.5_002&amp;rn=0&amp;bd=219&amp;p=-1&amp;x=0&amp;tp=0&amp;nw=1&amp;vs=0&amp;pi=&amp;pc=0&amp;cts=1420974668&amp;lts=&amp;y=103,1,2&amp;fa=4&amp;ut=0&amp;#8243;,&amp;#8221;version&amp;#8221;:&amp;#8221;2.0.8526&amp;#8243;,&amp;#8221;adSlots&amp;#8221;:[{&amp;#8220;startTime&amp;#8221;:0,&amp;#8221;duration&amp;#8221;:30,&amp;#8221;type&amp;#8221;:1,&amp;#8221;slotExtras&amp;#8221;:{},&amp;#8221;adZoneId&amp;#8221;:&amp;#8221;1000000000381&amp;#8243;,&amp;#8221;ads&amp;#8221;:[{&amp;#8220;adExtras&amp;#8221;:{},&amp;#8221;clickTracking&amp;#8221;:{&amp;#8220;adxTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000678217&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=1&amp;b=1420974669&amp;#8243;],&amp;#8221;cupidTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/track2?a=1&amp;b=1420974669&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;d=5000000675829&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000678217&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=dafea75e967cef6a25e0060b5aefbeb4&amp;t=iPhone&amp;u=1&amp;w=2&amp;up=&amp;v=5000000675829&amp;#8243;]},&amp;#8221;impressionId&amp;#8221;:&amp;#8221;1a9d6aa5607c24198908e4ecb7f36971&amp;#8243;,&amp;#8221;vid&amp;#8221;:&amp;#8221;327d76cda8d3e7c29a41a52f1cb41ff8&amp;#8243;,&amp;#8221;priority&amp;#8221;:88,&amp;#8221;dspId&amp;#8221;:71000001,&amp;#8221;order&amp;#8221;:1,&amp;#8221;duration&amp;#8221;:15,&amp;#8221;clickThroughUrl&amp;#8221;:&amp;#8221;http:\/\/wt.game.pps.tv\/index.php?m=adsmd&amp;c=tiepian&amp;a=index&amp;id=7421&amp;#8243;,&amp;#8221;impressionTracking&amp;#8221;:{&amp;#8220;adxTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000678217&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=0&amp;b=1420974669&amp;#8243;],&amp;#8221;cupidTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/track2?a=0&amp;b=1420974669&amp;c=1a9d6aa5607c24198908e4ecb7f36971&amp;d=5000000675829&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000678217&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=dafea75e967cef6a25e0060b5aefbeb4&amp;t=iPhone&amp;u=1&amp;w=2&amp;up=&amp;v=5000000675829&amp;#8243;]},&amp;#8221;creativeType&amp;#8221;:&amp;#8221;video_m3u8&amp;#8243;,&amp;#8221;clickThroughType&amp;#8221;:&amp;#8221;0&amp;#8243;,&amp;#8221;orderItemId&amp;#8221;:&amp;#8221;5000000675829&amp;#8243;,&amp;#8221;timePosition&amp;#8221;:&amp;#8221;2&amp;#8243;,&amp;#8221;adId&amp;#8221;:&amp;#8221;5000000677723&amp;#8243;,&amp;#8221;creativeObject&amp;#8221;:{},&amp;#8221;creativeUrl&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;creativeId&amp;#8221;:&amp;#8221;5000000678217&amp;#8243;},{&amp;#8220;adExtras&amp;#8221;:{},&amp;#8221;clickTracking&amp;#8221;:{&amp;#8220;adxTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000591849&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=1&amp;b=1420974669&amp;#8243;],&amp;#8221;cupidTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/track2?a=1&amp;b=1420974669&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;d=5000000589321&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000591849&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=ddfc1cc2443276e5f8a2ea298a7774a8&amp;t=iPhone&amp;u=1&amp;w=3&amp;up=&amp;v=5000000589321&amp;#8243;]},&amp;#8221;impressionId&amp;#8221;:&amp;#8221;84e5330e3497a4c52b4ecfcd84e98f05&amp;#8243;,&amp;#8221;vid&amp;#8221;:&amp;#8221;7d1bf186a55a5ae0bb2ad051666adb89&amp;#8243;,&amp;#8221;priority&amp;#8221;:88,&amp;#8221;dspId&amp;#8221;:71000001,&amp;#8221;order&amp;#8221;:2,&amp;#8221;duration&amp;#8221;:15,&amp;#8221;clickThroughUrl&amp;#8221;:&amp;#8221;http:\/\/serv.vip.iqiyi.com\/order\/preview.action?pid=a0226bd958843452&amp;platform=bb35a104d95490f6&amp;fc=a3dbfe9e7b9dba94#type=0&amp;#8243;,&amp;#8221;impressionTracking&amp;#8221;:{&amp;#8220;adxTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/etx?i=qc_100001_100070&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;q=5000000591849&amp;v=CAASEGseMM8pVUkpiJFs6m_FE1YaIDlhZTlmN2FkN2I4MzFiMDEyZjkwZjIxMzkyNTlhZmNj&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;k=331794000&amp;j=4&amp;d=81000009&amp;z=1000000000381&amp;ds=71000001&amp;du=15&amp;n=331794000&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;o=1&amp;e=104.200.18.10&amp;l=8e48946f144759d86a50075555fd5862&amp;r=0b05078afb5a24f5f97fadac83632383&amp;a=0&amp;b=1420974669&amp;#8243;],&amp;#8221;cupidTracking&amp;#8221;:[&amp;#8220;http:\/\/api.cupid.qiyi.com\/track2?a=0&amp;b=1420974669&amp;c=84e5330e3497a4c52b4ecfcd84e98f05&amp;d=5000000589321&amp;e=104.200.18.10&amp;f=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;g=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;h=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;i=qc_100001_100070&amp;j=4&amp;k=331794000&amp;kp=EAA3CC99-FAB0-46CC-B1A0-67B9BA89BB7F&amp;l=8e48946f144759d86a50075555fd5862&amp;m=iPhone4,1&amp;n=331794000&amp;o=1&amp;p=1000000000381&amp;q=5000000591849&amp;r=0b05078afb5a24f5f97fadac83632383&amp;s=ddfc1cc2443276e5f8a2ea298a7774a8&amp;t=iPhone&amp;u=1&amp;w=3&amp;up=&amp;v=5000000589321&amp;#8243;]},&amp;#8221;creativeType&amp;#8221;:&amp;#8221;video_m3u8&amp;#8243;,&amp;#8221;clickThroughType&amp;#8221;:&amp;#8221;3&amp;#8243;,&amp;#8221;orderItemId&amp;#8221;:&amp;#8221;5000000589321&amp;#8243;,&amp;#8221;timePosition&amp;#8221;:&amp;#8221;3&amp;#8243;,&amp;#8221;adId&amp;#8221;:&amp;#8221;5000000591634&amp;#8243;,&amp;#8221;creativeObject&amp;#8221;:{},&amp;#8221;creativeUrl&amp;#8221;:&amp;#8221;&amp;#8221;,&amp;#8221;creativeId&amp;#8221;:&amp;#8221;5000000591849&amp;#8243;}]}],&amp;#8221;videoEventId&amp;#8221;:&amp;#8221;0b05078afb5a24f5f97fadac83632383&amp;#8243;,&amp;#8221;finalUrl&amp;#8221;:&amp;#8221;http:\/\/cache.m.iqiyi.com\/dc\/amdt\/ae7578x3cd43d3f\/327d76cda8d3e7c29a41a52f1cb41ff8-7d1bf186a55a5ae0bb2ad051666adb89\/331794000\/bb620e84cffc480d53f85d8842697cee.m3u8?qd_asc=ae4f1fc1098e13132ea08c9490e419ee&amp;qd_asrc=8c40568b52a2483ea7e88a948c7ed664&amp;qd_at=1420974669569&amp;qypid=331794000_32&amp;#8243;}
    &lt;/p&gt;
  &lt;/blockquote&gt;
  
  &lt;p&gt;
    又一段非常长的文本，我想你我都懒得看内容了 &amp;#8211; 不过拜语义化带来的好处，我们一眼就能从 &lt;code&gt;ad_str&lt;/code&gt; 里判断它可能是广告入口。且在 Privoxy 里换掉它试试。
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;_Privoxy&#34;&gt;设定 Privoxy 规则&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;hey_Privoxy&#34; href=&#34;#_Privoxy&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    因为是过滤文本，所以要涉及 Privoxy 的两个文件：
  &lt;/p&gt;
  
  &lt;ul&gt;
    &lt;li&gt;
      user.filter
    &lt;/li&gt;
    &lt;li&gt;
      user.action
    &lt;/li&gt;
  &lt;/ul&gt;
  
  &lt;ol&gt;
    &lt;li&gt;
      &lt;p&gt;
        首先在 user.filter 文件中添加如下规则：
      &lt;/p&gt;
      
      &lt;pre&gt;&lt;code&gt;FILTER: blockQiyiAd 去除爱奇艺 iOS 版本视频广告
s|&#34;ad_str&#34;|&#34;fuck_ad_str&#34;|g
&lt;/code&gt;&lt;/pre&gt;
      
      &lt;p&gt;
        这里，我创建了一条规则，把 &lt;code&gt;ad_str&lt;/code&gt; 键名替换掉。
      &lt;/p&gt;
    &lt;/li&gt;
    
    &lt;li&gt;
      &lt;p&gt;
        然后在 user.action 文件中启用过滤规则：
      &lt;/p&gt;
      
      &lt;pre&gt;&lt;code&gt;{+filter{blockQiyiAd}}
iface2.iqiyi.com
&lt;/code&gt;&lt;/pre&gt;
      
      &lt;p&gt;
        再开启爱奇艺的客户端，视频广告已经不见。感谢语义，蒙对了。目前来看，也没有其他引发异常的副作用。
      &lt;/p&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;_Privoxy-2&#34;&gt;修改 Privoxy 监听地址&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;hey_Privoxy-2&#34; href=&#34;#_Privoxy-2&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    上面说明的是开启 charles 的情况，一旦 charles 关闭，我们就要把 iPhone 上的 HTTP PROXY 改为电脑上的 Privoxy 端口，比如 &lt;code&gt;192.168.1.102:8118&lt;/code&gt;。
  &lt;/p&gt;
  
  &lt;p&gt;
    但 Privoxy 默认监听的地址是 &lt;code&gt;127.0.0.1:8118&lt;/code&gt;，如果不做修改，会导致 iPhone 设置的 HTTP 代理无法访问。所以我新增一个 Privoxy 的监听地址。
  &lt;/p&gt;
  
  &lt;p&gt;
    打开 &lt;code&gt;config&lt;/code&gt; 文件，查找 &lt;code&gt;listen-address  127.0.0.1:8118&lt;/code&gt;，在它下一行新增如下内容：
  &lt;/p&gt;
  
  &lt;pre&gt;&lt;code&gt;listen-address  192.168.1.102:8118
&lt;/code&gt;&lt;/pre&gt;
  
  &lt;p&gt;
    其中 192.168.1.102 是我笔记本电脑的 IP。
  &lt;/p&gt;
  
  &lt;p&gt;
    最后，重启 Privoxy。
  &lt;/p&gt;
  
  &lt;p&gt;
    更多规则，请看我维护的 &lt;a href=&#34;https://github.com/chenxsan/Privoxy&#34;&gt;Privoxy 配置文件库&lt;/a&gt;。
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;i-2&#34;&gt;更新&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;heyi-2&#34; href=&#34;#i-2&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    2015.2.8 爱奇艺把 &amp;#8216;ad_str&amp;#8217; 换成 &amp;#8216;ad_info&amp;#8217; 了，配置文件已更新。
  &lt;/p&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>