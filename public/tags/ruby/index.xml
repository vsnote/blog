<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Ruby on 陈三</title>
    <link>https://www.zfanw.com/blog/tags/ruby/</link>
    <description>Recent content in Ruby on 陈三</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Tue, 19 May 2015 14:11:02 +0000</lastBuildDate>
    <atom:link href="https://www.zfanw.com/blog/tags/ruby/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>ERROR:  While executing gem … (Gem::RemoteFetcher::FetchError)</title>
      <link>https://www.zfanw.com/blog/error-while-executing-gem-gem-remote-fetch-error.html</link>
      <pubDate>Tue, 19 May 2015 14:11:02 +0000</pubDate>
      
      <guid>https://www.zfanw.com/blog/error-while-executing-gem-gem-remote-fetch-error.html</guid>
      <description>&lt;p&gt;我对命令行下安装 gem 包或是 npm 包有很大的心理阴影，因为出现无法​安装的概率实在太大了 &amp;#8211; 每次都要破口大骂 gfw。&lt;/p&gt;

&lt;p&gt;这一回是在更新 gem 时：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gem update --system
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;返回的错误如下：&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;ERROR: While executing gem &amp;#8230; (Gem::RemoteFetcher::FetchError)&lt;/p&gt;

&lt;p&gt;Errno::ETIMEDOUT: Operation timed out &amp;#8211; connect(2) for &amp;#8220;s3.amazonaws.com&amp;#8221; port 443 (&lt;a href=&#34;https://api.rubygems.org/specs.4.8.gz&#34;&gt;https://api.rubygems.org/specs.4.8.gz&lt;/a&gt;)&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;出现 s3 的地址是因为此前 &lt;a href=&#34;https://rubygems.org&#34;&gt;https://rubygems.org&lt;/a&gt; 源地址不行，所以执行了 &lt;code&gt;gem source&lt;/code&gt; 添加源库：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;gem source --add https://s3.amazonaws.com/production.s3.rubygems.org/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;如你所见，还是报错。&lt;/p&gt;

&lt;p&gt;查了资料，不巧 &lt;a href=&#34;http://stackoverflow.com/a/11128293&#34;&gt;StackOverflow 上这个问题提到了 Proxy&lt;/a&gt;，我国的国情，不挂代理简直混不下去 IT 业，所以我的 Mac OSX 的代理环境是这样的：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;privoxy(http://localhost:8118) -&amp;gt; sslEdge(http://localhost:100010)全局
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Privoxy 我是用来去除一些广告。且把死马当活马医吧：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;export http_proxy=http://localhost:8118
export https_proxy=http://localhost:8118 
gem update --system
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;然后目瞪口呆：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Updating rubygems-update
Fetching: rubygems-update-2.4.7.gem (100%)
Successfully installed rubygems-update-2.4.7
Parsing documentation for rubygems-update-2.4.7
Installing ri documentation for rubygems-update-2.4.7
Installing darkfish documentation for rubygems-update-2.4.7
Done installing documentation for rubygems-update after 2 seconds
Installing RubyGems 2.4.7
RubyGems 2.4.7 installed
Parsing documentation for rubygems-2.4.7
Installing ri documentation for rubygems-2.4.7
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;竟然真是代理的问题。所以我猜想是 iterm2 不支持 socks 代理，因此全局并未生效。而通过 Privoxy 的 HTTP 代理做一次转发，就正常了 &amp;#8211; 所以，还是 gfw 的问题。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>rails server 错误</title>
      <link>https://www.zfanw.com/blog/rails-server-fail.html</link>
      <pubDate>Mon, 17 Nov 2014 05:33:25 +0000</pubDate>
      
      <guid>https://www.zfanw.com/blog/rails-server-fail.html</guid>
      <description>

&lt;p&gt;在我安装好 Ruby on Rails 后，使用 &lt;code&gt;rails new&lt;/code&gt; 命令新建一个项目，然后切换到项目下执行 &lt;code&gt;rails server&lt;/code&gt;，出现如下错误：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sam@linux-qo4p:~/front/ror|master⚡⇒  rails server
Ignoring RedCloth-4.2.9 because its extensions are not built.  Try: gem pristine RedCloth-4.2.9
Ignoring posix-spawn-0.3.9 because its extensions are not built.  Try: gem pristine posix-spawn-0.3.9
Ignoring rdiscount-2.1.7.1 because its extensions are not built.  Try: gem pristine rdiscount-2.1.7.1
/usr/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:54:in `require&#39;: cannot load such file -- bundler/setup (LoadError)
        from /usr/lib/ruby/site_ruby/2.0.0/rubygems/core_ext/kernel_require.rb:54:in `require&#39;
        from /home/sam/front/ror/config/boot.rb:4:in `&amp;lt;top (required)&amp;gt;&#39;
        from bin/rails:3:in `require_relative&#39;
        from bin/rails:3:in `&amp;lt;main&amp;gt;&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;这似乎是我把 openSUSE 系统从 13.1 升级到 13.2 后才出现的错误。&lt;/p&gt;

&lt;p&gt;我的情况里，尝试错误信息中的提示方法 &lt;code&gt;gem pristine RedCloth&lt;/code&gt; 并不能消除以上错误。&lt;/p&gt;

&lt;p&gt;最后的解决办法是：&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;code&gt;gem pristine --all&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;切换到项目根目录，&lt;code&gt;bundle install&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;再次跑 &lt;code&gt;rails server&lt;/code&gt;，可以正常启动不报错。此后，&lt;code&gt;rails new&lt;/code&gt; 新建的项目也不再报错。&lt;/p&gt;

&lt;h2 id=&#34;参考&#34;&gt;参考&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://jeremy.wordpress.com/2014/03/14/how-to-rebuild-native-ruby-gems-after-a-libsystem-upgrade/&#34;&gt;How to rebuild native Ruby gems after a lib/system upgrade? | Jérémy Lecour&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>ERROR: Failed to build gem native extension</title>
      <link>https://www.zfanw.com/blog/error-failed-to-build-gem-native-extension.html</link>
      <pubDate>Mon, 25 Nov 2013 22:05:44 +0000</pubDate>
      
      <guid>https://www.zfanw.com/blog/error-failed-to-build-gem-native-extension.html</guid>
      <description>&lt;p&gt;&lt;a href=&#34;http://rubyonrails.org/download&#34;&gt;Ruby on Rails&lt;/a&gt; 网站上说，安装好 Ruby 后运行 &lt;code&gt;gem install rails&lt;/code&gt; 就好了。&lt;/p&gt;

&lt;p&gt;但整个过程折腾了我好几个小时。首先，openSUSE 13.1 自带有 Ruby 2.0.0p-247，我因为打算用 rbenv 管理 Ruby，就草率地把 Ruby 卸载：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ sudo zypper rm ruby
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;结果 Konsole 没了，YAST 没了，似乎连着 KDE 桌面都被卸掉。&lt;/p&gt;

&lt;p&gt;那么就先将就用系统自带的吧。但 &lt;code&gt;gem install rails&lt;/code&gt; 报错了：&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Building native extensions. This could take a while&amp;#8230;&lt;/p&gt;

&lt;p&gt;ERROR: Error installing rails:&lt;/p&gt;

&lt;p&gt;ERROR: Failed to build gem native extension.&lt;/p&gt;

&lt;p&gt;/usr/bin/ruby2.0 extconf.rb&lt;/p&gt;

&lt;p&gt;mkmf.rb can&amp;#8217;t find header files for ruby at /usr/lib/ruby/include/ruby.h&lt;/p&gt;

&lt;p&gt;Gem files will remain installed in /usr/lib/ruby/gems/2.0.0/gems/atomic-1.1.14 for inspection.&lt;/p&gt;

&lt;p&gt;Results logged to /usr/lib/ruby/gems/2.0.0/gems/atomic-1.1.14/ext/gem_make.out&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;code&gt;gem install compass&lt;/code&gt; 却是没有任何问题。&lt;/p&gt;

&lt;p&gt;网上的资料说要安装 ruby-devel：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo zypper in ruby-devel
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;再次安装 Rails，如你所见，从我开始写这篇到现在，还在安装中。但后来总算安装完成。&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>The Ruby openssl extension was not compiled. Missing the OpenSSL lib?</title>
      <link>https://www.zfanw.com/blog/the-ruby-openssl-extension-was-not-compiled-missing-the-openssl-lib.html</link>
      <pubDate>Sun, 24 Nov 2013 11:47:50 +0000</pubDate>
      
      <guid>https://www.zfanw.com/blog/the-ruby-openssl-extension-was-not-compiled-missing-the-openssl-lib.html</guid>
      <description>&lt;p&gt;我试图通过 &lt;a href=&#34;https://github.com/sstephenson/rbenv&#34;&gt;rbenv&lt;/a&gt; 安装 Ruby，但失败了，错误如标题所示。&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/sstephenson/ruby-build/issues/377&#34;&gt;Ruby-build&lt;/a&gt; 上有人报告类似的错误，作者也在 wiki 上给出相应的&lt;a href=&#34;https://github.com/sstephenson/ruby-build/wiki#suggested-build-environment&#34;&gt;环境要求&lt;/a&gt;说明。但里面并没有提到 openSUSE 系统。&lt;/p&gt;

&lt;p&gt;依他们的思路，我查找了 openSUSE 下的相应 openssl 包：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ zypper se openssl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;找到的有 libopenssl-devel 等，&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ sudo zypper in libopenssl-devel
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;之后再通过 rbenv 安装：&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ rben install 2.0.0-p353
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;结果是：&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Installed ruby-2.0.0-p353 to /home/sam/.rbenv/versions/2.0.0-p353&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;不再报错，成功安装 Ruby 2.0.0-p353。&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>