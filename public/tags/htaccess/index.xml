<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Htaccess on 陈三</title>
    <link>https://www.zfanw.com/blog/tags/htaccess/</link>
    <description>Recent content in Htaccess on 陈三</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh</language>
    <lastBuildDate>Tue, 25 Sep 2012 05:39:04 +0000</lastBuildDate>
    <atom:link href="https://www.zfanw.com/blog/tags/htaccess/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>NO WWW</title>
      <link>https://www.zfanw.com/blog/no-www.html</link>
      <pubDate>Tue, 25 Sep 2012 05:39:04 +0000</pubDate>
      
      <guid>https://www.zfanw.com/blog/no-www.html</guid>
      <description>&lt;div id=&#34;toc_container&#34; class=&#34;ml-l u-floatRight pure-u-1-1 pure-u-sm-2-5 toc_white no_bullets&#34;&gt;
  &lt;nav id=&#34;myaffix&#34;&gt;
  
  &lt;p class=&#34;toc-title&#34;&gt;
    目录
  &lt;/p&gt;
  
  &lt;ul class=&#34;toc-list nav&#34; role=&#34;menu&#34;&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#_no-www&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;1&lt;/span&gt; 为什么要 no-www&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#i&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;2&lt;/span&gt; 具体实践情况&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#no-www_301_www&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;3&lt;/span&gt; no-www 301 重定向到 www&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#www_301_no-www&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;4&lt;/span&gt; www 301 重定向到 no-www&lt;/a&gt;
    &lt;/li&gt;
    &lt;li class=&#34;toc-list__item&#34; role=&#34;menuitem&#34;&gt;
      &lt;a href=&#34;#i-2&#34;&gt;&lt;span class=&#34;toc_number toc_depth_1&#34;&gt;5&lt;/span&gt; 鸣谢&lt;/a&gt;
    &lt;/li&gt;
  &lt;/ul&gt;&lt;/nav&gt;
&lt;/div&gt;

&lt;div class=&#34;&#34;&gt;
  &lt;p&gt;
    首先，这标题绝非我拒绝使用 WWW （互联网）的意思。只是在讲域名中不要加 www。另外，这也不是我的主张，只是看到互联网上有&lt;a href=&#34;http://no-www.org/&#34;&gt;这么个主张&lt;/a&gt;，就介绍一下。
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;_no-www&#34;&gt;为什么要 no-www&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;hey_no-www&#34; href=&#34;#_no-www&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    对普通互联网使用者来说，域名中 www 或 no-www 其实并无关系，只要能正常访问网站即可。但按 &lt;a href=&#34;http://no-www.org/&#34;&gt;No-WWW&lt;/a&gt; 网站的说法，则 www 其实是多余的：
  &lt;/p&gt;
  
  &lt;blockquote&gt;
    &lt;p&gt;
      默认情况下，所有流行的浏览器都默认 HTTP 协议。如此，浏览器就会在请求的 URL 地址前自动补上 ‘http://’，然后自动连接 HTTP 服务器上的 80 端口&amp;#8230;&amp;#8230;Web 服务器允许通过主域名访问页面，除非指定特殊子域名。
    &lt;/p&gt;
    
    &lt;p&gt;
      简单说，使用 www 子域名根本是多余的，空耗费连接时间。
    &lt;/p&gt;
  &lt;/blockquote&gt;
  
  &lt;p&gt;
    当然，有说 no-www 的，肯定就有 &lt;a href=&#34;http://www.yes-www.org/&#34;&gt;yes-www&lt;/a&gt; 的，理由也不少。
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;i&#34;&gt;具体实践情况&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;heyi&#34; href=&#34;#i&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    那么来看下具体实践的情况。
  &lt;/p&gt;
  
  &lt;p&gt;
    这是 Quantcast 美国的 &lt;a href=&#34;http://www.quantcast.com/top-sites&#34;&gt;top sites&lt;/a&gt; 数据。我抽取前 20 名来做个统计：
  &lt;/p&gt;
  
  &lt;table class=&#34;table table-striped table-hover table-bordered table-condensed&#34;&gt;
    &lt;tr&gt;
      &lt;th&gt;
        no-www&amp;nbsp;&amp;rarr;&amp;nbsp;www
      &lt;/th&gt;
      
      &lt;th&gt;
        www&amp;nbsp;&amp;rarr;&amp;nbsp;no-www
      &lt;/th&gt;
      
      &lt;th&gt;
        未曾做重定向
      &lt;/th&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        google.com
      &lt;/td&gt;
      
      &lt;td&gt;
        twitter.com
      &lt;/td&gt;
      
      &lt;td&gt;
        ask.com
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        youtube.com
      &lt;/td&gt;
      
      &lt;td&gt;
        vimeo.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        facebook.com
      &lt;/td&gt;
      
      &lt;td&gt;
        pinterest.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        msn.com
      &lt;/td&gt;
      
      &lt;td&gt;
        wordpress.org
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        yahoo.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        amazon.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        wikipedia.org
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        ebay.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        microsoft.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        huffingtonpost.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        bing.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        ehow.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        blogspot.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        answers.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
    
    &lt;tr&gt;
      &lt;td&gt;
        blogger.com
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
      
      &lt;td&gt;
      &lt;/td&gt;
    &lt;/tr&gt;
  &lt;/table&gt;
  
  &lt;p&gt;
    可以看到，除了 ask 不曾统一网址外，所有其他网站均做了网址的重定向，或 no-www 重定向到 www，或 www 重定向到 no-www。
  &lt;/p&gt;
  
  &lt;p&gt;
    其实按我理解，则重定向网址的需求更多不是因为 no-www 或 yes-www 提出的理由，而是出于&lt;a href=&#34;http://www.mattcutts.com/blog/seo-advice-url-canonicalization/&#34;&gt;讨好搜索引擎的需要&lt;/a&gt;。
  &lt;/p&gt;
  
  &lt;p&gt;
    举我的博客为例，如果不做重定向，则以下网址访问的内容其实是一致的：
  &lt;/p&gt;
  
  &lt;ol&gt;
    &lt;li&gt;
      http://www.zfanw.com/blog
    &lt;/li&gt;
    &lt;li&gt;
      http://zfanw.com/blog
    &lt;/li&gt;
  &lt;/ol&gt;
  
  &lt;p&gt;
    用户可能不关心它是有 www 还是没有，但搜索引擎会注意到这点。具体可以看 Google 网站工具上“&lt;a href=&#34;http://support.google.com/webmasters/bin/answer.py?hl=zh-Hans&amp;hlrm=en&amp;answer=139066&#34;&gt;规范化&lt;/a&gt;&amp;#8220;的说明。
  &lt;/p&gt;
  
  &lt;p&gt;
    那么如何实现 no-www 到 www 或是 www 到 no-www 的 301 重定向？简单的办法是通过 .htaccess 文件设置。
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;no-www_301_www&#34;&gt;no-www 301 重定向到 www&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;heyno-www_301_www&#34; href=&#34;#no-www_301_www&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    在 .htaccess 文件中加入以下代码：
  &lt;/p&gt;
  
  &lt;pre&gt;&lt;code&gt;#####301 跳转所有 no-www 到 www
RewriteEngine On
RewriteCond %{HTTP_HOST} ^[^.]+\.[^.]+$ [NC]
RewriteRule ^(.*)$ http://www.%{http_host}/$1 [R=301,NC]
&lt;/code&gt;&lt;/pre&gt;
  
  &lt;p&gt;
    这样，输入网址 http://zfanw.com/blog 就会跳转到网址 http://www.zfanw.com/blog
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;www_301_no-www&#34;&gt;www 301 重定向到 no-www&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;heywww_301_no-www&#34; href=&#34;#www_301_no-www&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;p&gt;
    类似的，在 .htaccess 文件加入如下代码：
  &lt;/p&gt;
  
  &lt;pre&gt;&lt;code&gt;#####301 跳转所有 www 到 no-www
RewriteEngine On
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^(.*)$ http://%1/$1 [R=301,L] 
&lt;/code&gt;&lt;/pre&gt;
  
  &lt;p&gt;
    这样，输入网址 http://www.zfanw.com/blog 就会跳转到网址 http://zfanw.com/blog
  &lt;/p&gt;
  
  &lt;h2 class=&#34;storycontent-h2&#34;&gt;
    &lt;span id=&#34;i-2&#34;&gt;鸣谢&lt;/span&gt;&lt;a title=&#34;标题链接地址&#34; class=&#34;u-floatRight hidden&#34; id=&#34;heyi-2&#34; href=&#34;#i-2&#34;&gt;&lt;span class=&#34;&#34; aria-hidden=&#34;true&#34;&gt;#&lt;/span&gt;&lt;/a&gt;
  &lt;/h2&gt;
  
  &lt;ol&gt;
    &lt;li&gt;
      &lt;a href=&#34;http://wiki.apache.org/httpd/CanonicalHostNames&#34;&gt;apache wiki&lt;/a&gt;
    &lt;/li&gt;
  &lt;/ol&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>