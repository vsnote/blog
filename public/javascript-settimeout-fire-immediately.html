<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.16" />


<title>JavaScript setTimeout 居然立即执行了 - 陈三</title>
<meta property="og:title" content="JavaScript setTimeout 居然立即执行了 - 陈三">



  






<link rel="stylesheet" href="https://www.zfanw.com/blog/css/main.css" media="all">

  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="https://www.zfanw.com/blog/" class="nav-logo">陈三</a>

  <ul class="nav-links">
    
    <li><a href="/blog/">Home</a></li>
    
    <li><a href="/blog/about/">关于</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">1 min read</span>
    

    <h1 class="article-title">JavaScript setTimeout 居然立即执行了</h1>

    
    <span class="article-date">May 5, 2015</span>
    

    <div class="article-content">
      <p>在我的经历里，有过类似以下的一段代码：</p>

<pre><code>setTimeout(function() { console.log('sam chen'); }, 2591700000);
</code></pre>

<p>Ooooooops，立即执行了。而不是我们所预想的，会在至少 2591700000ms 后触发。</p>

<p>原因是这样的<sup class="footnote-ref" id="fnref:15918-1"><a rel="footnote" href="#fn:15918-1">1</a></sup>：</p>

<blockquote>
<p>Timeout values too big to fit into a signed 32-bit integer may cause overflow in FF, Safari, and Chrome, resulting in the timeout being scheduled immediately. It makes more sense simply not to schedule these timeouts, since 24.8 days is beyond a reasonable expectation for the browser to stay open.</p>
</blockquote>

<p><code>setTimeout</code> 的第二个参数 timeout 的最大值是 2147483647<sup class="footnote-ref" id="fnref:15918-2"><a rel="footnote" href="#fn:15918-2">2</a></sup>，我们的设定值超过它，回调函数就会立即执行。</p>
<div class="footnotes">

<hr />

<ol>
<li id="fn:15918-1"><a href="https://code.google.com/p/closure-library/source/browse/closure/goog/timer/timer.js?r=7205c0d2f9ef6e079ba626e3c83d93dddf65de67#79">closure timer.js &#8211; code.google.com</a>
 <a class="footnote-return" href="#fnref:15918-1"><sup>[return]</sup></a></li>
<li id="fn:15918-2"><a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowTimers/setTimeout#Minimum.2Fmaximum_delay_and_timeout_nesting">最大/最小延迟值 &#8211; MDN</a>
 <a class="footnote-return" href="#fnref:15918-2"><sup>[return]</sup></a></li>
</ol>
</div>

    </div>
  </article>

  

</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="https://www.zfanw.com/blog/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with Hugo</a>
          </li>
        </ul>
      </footer>

    </div>

    
  </body>
</html>

