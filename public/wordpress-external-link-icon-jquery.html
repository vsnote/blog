<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Hugo 0.16" />


<title>给 WordPress 博客外部链接添加小图标 - 陈三</title>
<meta property="og:title" content="给 WordPress 博客外部链接添加小图标 - 陈三">



  






<link rel="stylesheet" href="https://www.zfanw.com/blog/css/main.css" media="all">

  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <nav class="nav">
  <a href="https://www.zfanw.com/blog/" class="nav-logo">陈三</a>

  <ul class="nav-links">
    
    <li><a href="/blog/">Home</a></li>
    
    <li><a href="/blog/about/">关于</a></li>
    
  </ul>
</nav>

      </header>


<main class="content" role="main">

  <article class="article">
    
    <span class="article-duration">1 min read</span>
    

    <h1 class="article-title">给 WordPress 博客外部链接添加小图标</h1>

    
    <span class="article-date">September 9, 2012</span>
    

    <div class="article-content">
      

<p>我的博客里，凡外部链接，它的右侧都有个小图标，用于标示出站链接，比如 <a href="http://wordpress.org/">WordPress</a>。</p>

<p>最早打算使用 CSS 属性选择器，如下：</p>

<pre><code>.storycontent a{
    text-decoration:none;
    color:#000;
    padding-right:16px;
    background:url(http://www.zfanw.com/blog/wp-content/uploads/2012/08/icon_external.png)
        right center no-repeat;
}
.storycontent a[href^=&quot;http://www.zfanw.com/blog&quot;],
.storycontent a[href^=&quot;#&quot;]{
    background:none;
    padding-right:0;
}
</code></pre>

<p>但这有个不足，IE6 不支持属性选择符(时至2013-10-25，你还要支持 IE6 吗，我真同情你)。</p>

<p>另外一个办法，就是给外部链接加 class，比如 .external，然后赋予类某种样式，就没有浏览器兼容性问题。</p>

<p>这个方法要用到 WordPress 的 filter，the_content。</p>

<p>首先，在 functions.php 文件里创建一个函数 addExternalClass，用于过滤页面内容，之后再添加过滤勾子，这样内容在输出到屏幕前会按照我们的设定进行预处理：</p>

<pre><code>function addExternalClass($content) {
    $content = str_replace('&lt;a href=', '&lt;a class=&quot;external&quot; href=', $content);
    //首先将页面里所有链接都加上 .external 类
    $content = str_replace('&lt;a class=&quot;external&quot; href=&quot;http://www.zfanw.com', '&lt;a href=&quot;http://www.zfanw.com', $content);
    //将带本站 url 地址 http://www.zfanw.com 的链接的类 .external 移除。
    $content = str_replace('&lt;a class=&quot;external&quot; href=&quot;#', '&lt;a href=&quot;#', $content);
    //将锚链接的 .external 类移除
    return $content;
    //返回处理过的内容
}
add_filter('the_content', 'addExternalClass');
</code></pre>

<p>再之后，就是到 style.css 里给类 .external 写个规则：</p>

<pre><code>.external{
    text-decoration:none;
    border-bottom:1px dashed #333;
    color:#000;
    padding-right:16px;
    background:url(http://www.zfanw.com/blog/wp-content/uploads/2012/08/icon_external.png)
        right center no-repeat;
}
</code></pre>

<p>如果要让外部链接在新窗口打开，过滤函数里加个 &#8220;target=&#8217;_blank&rsquo;&#8221; 就可以。</p>

<p>第三种办法，通过 jQuery filter 函数选择所有外部链接并添加 .external 类：</p>

<pre><code>jQuery('a').filter(function() {
   return this.hostname &amp;&amp; this.hostname !== location.hostname;
}).addClass(&quot;external&quot;);
</code></pre>

<h2 id="鸣谢">鸣谢</h2>

<ol>
<li><a href="http://codex.wordpress.org/Plugin_API/Filter_Reference/the_content">http://codex.wordpress.org/Plugin_API/Filter_Reference/the_content</a></li>
<li><a href="http://api.jquery.com/filter/">http://api.jquery.com/filter/</a></li>
<li><a href="http://css-tricks.com/snippets/jquery/target-only-external-links/">http://css-tricks.com/snippets/jquery/target-only-external-links/</a></li>
</ol>

    </div>
  </article>

  

</main>

      <footer class="footer">
        <ul class="footer-links">
          <li>
            <a href="https://www.zfanw.com/blog/index.xml" type="application/rss+xml" target="_blank">RSS feed</a>
          </li>
          <li>
            <a href="https://gohugo.io/" class="footer-links-kudos">Made with Hugo</a>
          </li>
        </ul>
      </footer>

    </div>

    
  </body>
</html>

